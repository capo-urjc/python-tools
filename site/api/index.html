<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>API - Documentación del Proyecto</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../assets/_mkdocstrings.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Documentación del Proyecto</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">API</a>
                            </li>
                            <li class="nav-item">
                                <a href="../develop/" class="nav-link">Develop</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href=".." class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../develop/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#api-reference" class="nav-link">API Reference</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.CAVE.dataset" class="nav-link">dataset</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.CAVE.dataset.CAVEDataset" class="nav-link">CAVEDataset</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.CAVE.tools" class="nav-link">tools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.CAVE.utils.downsampling" class="nav-link">downsampling</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.CAVE.utils.downsampling.DownSampling_LossChannels" class="nav-link">DownSampling_LossChannels</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.CAVE.utils.extract_random_patch" class="nav-link">extract_random_patch</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.CAVE.utils.extract_random_patch.extract_random_patch" class="nav-link">extract_random_patch</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.ETS2.dataset" class="nav-link">dataset</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.ETS2.dataset.ETS2Dataset" class="nav-link">ETS2Dataset</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.ETS2.dataset.ETS2DatasetVideo" class="nav-link">ETS2DatasetVideo</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.ETS2.dataset.ToTensor" class="nav-link">ToTensor</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.ETS2.ets2_tools.depth_file" class="nav-link">depth_file</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFile" class="nav-link">ETS2DepthFile</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFileHeader" class="nav-link">ETS2DepthFileHeader</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.display.tools.depth_tools" class="nav-link">depth_tools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.pt_functions.ffts" class="nav-link">ffts</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.pt_functions.ffts.ffp3d" class="nav-link">ffp3d</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#capo_tools.pt_functions.ffts.psf2otf3d" class="nav-link">psf2otf3d</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="capo_tools.datasets.CAVE.dataset"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="capo_tools.datasets.CAVE.dataset.CAVEDataset" class="doc doc-heading">
            <code>CAVEDataset</code>


<a href="#capo_tools.datasets.CAVE.dataset.CAVEDataset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.utils.data.Dataset">Dataset</span></code></p>


        <p>Dataset class for loading Hyperspectral images dataset (CAVE).</p>






              <details class="quote">
                <summary>Source code in <code>src/capo_tools/datasets/CAVE/dataset.py</code></summary>
                <pre class="codehilite"><code class="language-python">class CAVEDataset(Dataset):
    """
    Dataset class for loading Hyperspectral images dataset (CAVE).
    """

    def __init__(self, root_dir: str, patch_size: tuple, transform=None, download=False, mode='train'):
        """
        Initializes the dataset by loading the data.

        Args:
            root_dir (str): Root directory where the dataset is stored.
            patch_size (tuple): Size of the patch to be extracted from the images.
            transform (callable, optional): Optional transform to be applied on the samples.
            download (bool, optional): If True, downloads the dataset from the internet if it's not already downloaded.
            mode (str, optional): Mode of the dataset ('train', 'valid', 'test'.).
        """

        if not os.path.exists(root_dir):
            print('Downloading CAVE dataset:')
            download_CAVE(path_to_save=root_dir)

        if download:
            if not os.path.exists(root_dir):
                print('Downloading CAVE dataset:')
                download_CAVE(path_to_save=root_dir)
            else:
                print('Downloading and restoring CAVE dataset:')
                shutil.rmtree(root_dir)
                download_CAVE(path_to_save=root_dir)

        self.root_dir = os.path.join(root_dir, mode)
        self.patch_size = patch_size
        self.transform = transform

        self.images: list = []

        images_paths: list = sorted(os.listdir(self.root_dir))

        for path in images_paths:
            numpy_image: np.ndarray = np.load(os.path.join(self.root_dir, path))
            padded_image: np.ndarray = np.pad(numpy_image, (self.patch_size, self.patch_size, (0, 0)), 'constant',
                                              constant_values=0)
            self.images.append(padded_image)
        print('CAVE dataset loaded.')

    def __len__(self):
        """
        Get the total number of images in the dataset.

        Returns:
            int: Total number of images.
        """
        return len(self.images)

    def __getitem__(self, idx):
        """
        Get a sample from the dataset at the specified index.

        Args:
            idx (int): Index of the sample to retrieve.

        Returns:
            torch.Tensor: Transformed sample.
        """
        if torch.is_tensor(idx):
            idx = idx.tolist()

        idx = idx % len(self.images)

        image = self.images[idx]

        image: np.ndarray = extract_random_patch(image, self.patch_size)

        image = image.astype(np.float32)

        if self.transform:
            sample = self.transform(image)
        else:
            sample = transforms.ToTensor()(image)

        return sample</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.CAVE.dataset.CAVEDataset.__getitem__" class="doc doc-heading">
            <code class=" language-python">__getitem__(idx)</code>

<a href="#capo_tools.datasets.CAVE.dataset.CAVEDataset.__getitem__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a sample from the dataset at the specified index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>idx</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the sample to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.Tensor: Transformed sample.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/CAVE/dataset.py</code></summary>
              <pre class="codehilite"><code class="language-python">def __getitem__(self, idx):
    """
    Get a sample from the dataset at the specified index.

    Args:
        idx (int): Index of the sample to retrieve.

    Returns:
        torch.Tensor: Transformed sample.
    """
    if torch.is_tensor(idx):
        idx = idx.tolist()

    idx = idx % len(self.images)

    image = self.images[idx]

    image: np.ndarray = extract_random_patch(image, self.patch_size)

    image = image.astype(np.float32)

    if self.transform:
        sample = self.transform(image)
    else:
        sample = transforms.ToTensor()(image)

    return sample</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.CAVE.dataset.CAVEDataset.__init__" class="doc doc-heading">
            <code class=" language-python">__init__(root_dir, patch_size, transform=None, download=False, mode='train')</code>

<a href="#capo_tools.datasets.CAVE.dataset.CAVEDataset.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initializes the dataset by loading the data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>root_dir</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Root directory where the dataset is stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>patch_size</code>
            </td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the patch to be extracted from the images.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transform</code>
            </td>
            <td>
                  <code>callable</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional transform to be applied on the samples.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>download</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, downloads the dataset from the internet if it's not already downloaded.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode of the dataset ('train', 'valid', 'test'.).</p>
              </div>
            </td>
            <td>
                  <code>&#39;train&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/CAVE/dataset.py</code></summary>
              <pre class="codehilite"><code class="language-python">def __init__(self, root_dir: str, patch_size: tuple, transform=None, download=False, mode='train'):
    """
    Initializes the dataset by loading the data.

    Args:
        root_dir (str): Root directory where the dataset is stored.
        patch_size (tuple): Size of the patch to be extracted from the images.
        transform (callable, optional): Optional transform to be applied on the samples.
        download (bool, optional): If True, downloads the dataset from the internet if it's not already downloaded.
        mode (str, optional): Mode of the dataset ('train', 'valid', 'test'.).
    """

    if not os.path.exists(root_dir):
        print('Downloading CAVE dataset:')
        download_CAVE(path_to_save=root_dir)

    if download:
        if not os.path.exists(root_dir):
            print('Downloading CAVE dataset:')
            download_CAVE(path_to_save=root_dir)
        else:
            print('Downloading and restoring CAVE dataset:')
            shutil.rmtree(root_dir)
            download_CAVE(path_to_save=root_dir)

    self.root_dir = os.path.join(root_dir, mode)
    self.patch_size = patch_size
    self.transform = transform

    self.images: list = []

    images_paths: list = sorted(os.listdir(self.root_dir))

    for path in images_paths:
        numpy_image: np.ndarray = np.load(os.path.join(self.root_dir, path))
        padded_image: np.ndarray = np.pad(numpy_image, (self.patch_size, self.patch_size, (0, 0)), 'constant',
                                          constant_values=0)
        self.images.append(padded_image)
    print('CAVE dataset loaded.')</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.CAVE.dataset.CAVEDataset.__len__" class="doc doc-heading">
            <code class=" language-python">__len__()</code>

<a href="#capo_tools.datasets.CAVE.dataset.CAVEDataset.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the total number of images in the dataset.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of images.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/CAVE/dataset.py</code></summary>
              <pre class="codehilite"><code class="language-python">def __len__(self):
    """
    Get the total number of images in the dataset.

    Returns:
        int: Total number of images.
    """
    return len(self.images)</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="capo_tools.datasets.CAVE.tools"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="capo_tools.datasets.CAVE.utils.downsampling"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="capo_tools.datasets.CAVE.utils.downsampling.DownSampling_LossChannels" class="doc doc-heading">
            <code>DownSampling_LossChannels</code>


<a href="#capo_tools.datasets.CAVE.utils.downsampling.DownSampling_LossChannels" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>


        <p>Crop the given image at a random location.</p>






              <details class="quote">
                <summary>Source code in <code>src/capo_tools/datasets/CAVE/utils/downsampling.py</code></summary>
                <pre class="codehilite"><code class="language-python">class DownSampling_LossChannels(torch.nn.Module):
    """
    Crop the given image at a random location.
    """
    def __init__(self, loss_ch=None):
        super().__init__()
        self.loss_ch = loss_ch or list(range(1, 31, 2))

    def forward(self, y):
        """
        Args:
            y (Tensor): Image to be downsampled channel-wise. [ch, height, width]

        Returns:
            Dict of Tensors: {'x': Downsampled image with lost channels set to 0, 'y': y}
        """
        x = y.clone()
        x[self.loss_ch, ...] = 0

        return {'x': x, 'y': y}</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.CAVE.utils.downsampling.DownSampling_LossChannels.forward" class="doc doc-heading">
            <code class=" language-python">forward(y)</code>

<a href="#capo_tools.datasets.CAVE.utils.downsampling.DownSampling_LossChannels.forward" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image to be downsampled channel-wise. [ch, height, width]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of Tensors: {'x': Downsampled image with lost channels set to 0, 'y': y}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/CAVE/utils/downsampling.py</code></summary>
              <pre class="codehilite"><code class="language-python">def forward(self, y):
    """
    Args:
        y (Tensor): Image to be downsampled channel-wise. [ch, height, width]

    Returns:
        Dict of Tensors: {'x': Downsampled image with lost channels set to 0, 'y': y}
    """
    x = y.clone()
    x[self.loss_ch, ...] = 0

    return {'x': x, 'y': y}</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="capo_tools.datasets.CAVE.utils.extract_random_patch"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="capo_tools.datasets.CAVE.utils.extract_random_patch.extract_random_patch" class="doc doc-heading">
            <code class=" language-python">extract_random_patch(image, size)</code>

<a href="#capo_tools.datasets.CAVE.utils.extract_random_patch.extract_random_patch" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Extracts a random patch of size 'size' from the input image.
Zero padding is applied if the patch exceeds the image boundaries.</p>
<p>Parameters:
- image: NumPy array representing the input image.
- size: Tuple (height, width) specifying the size of the patch.</p>
<p>Returns:
- patch: NumPy array representing the extracted patch.</p>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/CAVE/utils/extract_random_patch.py</code></summary>
              <pre class="codehilite"><code class="language-python">def extract_random_patch(image, size):
    """
    Extracts a random patch of size 'size' from the input image.
    Zero padding is applied if the patch exceeds the image boundaries.

    Parameters:
    - image: NumPy array representing the input image.
    - size: Tuple (height, width) specifying the size of the patch.

    Returns:
    - patch: NumPy array representing the extracted patch.
    """

    # Get image dimensions
    img_height, img_width = image.shape[:2]
    patch_height, patch_width = size

    # Choose random starting coordinates for the patch
    start_row = np.random.randint(0, img_height - patch_height + 1)
    start_col = np.random.randint(0, img_width - patch_width + 1)

    # Extract the patch
    patch = image[start_row:start_row + patch_height, start_col:start_col + patch_width]

    return patch</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="capo_tools.datasets.ETS2.dataset"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="capo_tools.datasets.ETS2.dataset.ETS2Dataset" class="doc doc-heading">
            <code>ETS2Dataset</code>


<a href="#capo_tools.datasets.ETS2.dataset.ETS2Dataset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.utils.data.Dataset">Dataset</span></code></p>


        <p>Pytorch Dataset for ETS2 dataset, single frame</p>
<p>The ETS2 Dataset, Synthetic Data from Video Games for Monocular Depth Estimation
https://link.springer.com/chapter/10.1007/978-3-031-36616-1_30</p>






              <details class="quote">
                <summary>Source code in <code>src/capo_tools/datasets/ETS2/dataset.py</code></summary>
                <pre class="codehilite"><code class="language-python">class ETS2Dataset(Dataset):
    """
    Pytorch Dataset for ETS2 dataset, single frame

    The ETS2 Dataset, Synthetic Data from Video Games for Monocular Depth Estimation
    https://link.springer.com/chapter/10.1007/978-3-031-36616-1_30
    """
    def __init__(self, data_path, indexes, image_type: str = 'bmp', is_train: bool = False, transform=None):
        super(ETS2Dataset, self).__init__()
        self.data_path = data_path
        self.image_type = image_type
        self.is_train = is_train
        self.data = get_data(self.data_path)
        self.indexes = indexes if indexes is not None else list(range(len(self.data)))
        self.transform = transform if transform is not None else ToTensor()

    def __getitem__(self, item):
        """
        Get a single frame from the dataset
        Returns a tuple with the image and the depth map and a dictionary with the metadata
        """
        index = self.indexes[item]
        row = self.data.iloc[index]
        file_path = os.path.join(self.data_path, row['session'], row['capture'])
        image = Image.open(f"{file_path}.{self.image_type}")

        depth_file = read_depth_file(f"{file_path}.depth.raw")
        header = depth_file.header
        depth = depth_file.get_data()
        depth_shape = (header.height, header.width, 1)
        depth = np.reshape(depth, depth_shape)

        sample = {'image': image, 'depth': depth, 'frame': file_path, 'metadata': row}

        if self.transform:
            sample = self.transform(sample)

        return sample

    def __len__(self):
        """
        Get the number of frames in the dataset
        """
        return len(self.indexes)</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.ETS2.dataset.ETS2Dataset.__getitem__" class="doc doc-heading">
            <code class=" language-python">__getitem__(item)</code>

<a href="#capo_tools.datasets.ETS2.dataset.ETS2Dataset.__getitem__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a single frame from the dataset
Returns a tuple with the image and the depth map and a dictionary with the metadata</p>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/ETS2/dataset.py</code></summary>
              <pre class="codehilite"><code class="language-python">def __getitem__(self, item):
    """
    Get a single frame from the dataset
    Returns a tuple with the image and the depth map and a dictionary with the metadata
    """
    index = self.indexes[item]
    row = self.data.iloc[index]
    file_path = os.path.join(self.data_path, row['session'], row['capture'])
    image = Image.open(f"{file_path}.{self.image_type}")

    depth_file = read_depth_file(f"{file_path}.depth.raw")
    header = depth_file.header
    depth = depth_file.get_data()
    depth_shape = (header.height, header.width, 1)
    depth = np.reshape(depth, depth_shape)

    sample = {'image': image, 'depth': depth, 'frame': file_path, 'metadata': row}

    if self.transform:
        sample = self.transform(sample)

    return sample</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.ETS2.dataset.ETS2Dataset.__len__" class="doc doc-heading">
            <code class=" language-python">__len__()</code>

<a href="#capo_tools.datasets.ETS2.dataset.ETS2Dataset.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the number of frames in the dataset</p>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/ETS2/dataset.py</code></summary>
              <pre class="codehilite"><code class="language-python">def __len__(self):
    """
    Get the number of frames in the dataset
    """
    return len(self.indexes)</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="capo_tools.datasets.ETS2.dataset.ETS2DatasetVideo" class="doc doc-heading">
            <code>ETS2DatasetVideo</code>


<a href="#capo_tools.datasets.ETS2.dataset.ETS2DatasetVideo" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.utils.data.Dataset">Dataset</span></code></p>


        <p>Pytorch Dataset for ETS2 dataset, video sequence</p>
<p>The ETS2 Dataset, Synthetic Data from Video Games for Monocular Depth Estimation
https://link.springer.com/chapter/10.1007/978-3-031-36616-1_30</p>






              <details class="quote">
                <summary>Source code in <code>src/capo_tools/datasets/ETS2/dataset.py</code></summary>
                <pre class="codehilite"><code class="language-python">class ETS2DatasetVideo(Dataset):
    """
    Pytorch Dataset for ETS2 dataset, video sequence

    The ETS2 Dataset, Synthetic Data from Video Games for Monocular Depth Estimation
    https://link.springer.com/chapter/10.1007/978-3-031-36616-1_30
    """
    def __init__(self, indexes, data_path, is_train=False, transform=None, max_depth: float = 80.0):
        super(ETS2DatasetVideo, self).__init__()
        self.data_path = data_path
        self.is_train = is_train
        self.data_indexes = indexes
        self.data = get_data(data_path)
        self.transform = transform
        self.maxDepth = max_depth

    def __getitem__(self, item):
        sequence_start_index = self.data_indexes[item]

        # TODO: parametrize number of frames in sequence
        sequence_end_index = sequence_start_index + 10

        data_rows = self.data.iloc[sequence_start_index:sequence_end_index, :]
        files = [os.path.join(self.data_path, x) for x in (data_rows['session'] + "/" + data_rows['capture']).tolist()]

        x = []
        y = []
        metadata = []

        for index, file in enumerate(files):
            file_path = f"{file}.jpg"
            image = Image.open(file_path)

            depth_file = read_depth_file(f"{file}.depth.raw")
            header = depth_file['header']
            depth = -depth_file['data']
            depth_shape = (header['height'], header['width'], 1)
            depth = np.reshape(depth, depth_shape)

            sample = {'image': image, 'depth': depth, 'frame': file}
            sample = self.transform(sample)
            x.append(sample['image'])
            y.append(sample['depth'])

            data_row = data_rows.iloc[index]
            metadata.append({"path": file_path, "session": data_row['session'], "capture": data_row['capture']})

        x = torch.stack((x))
        y = torch.stack((y))

        return x, y, metadata

    def __len__(self):
        return len(self.data_indexes)</code></pre>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="capo_tools.datasets.ETS2.dataset.ToTensor" class="doc doc-heading">
            <code>ToTensor</code>


<a href="#capo_tools.datasets.ETS2.dataset.ToTensor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>object</code></p>


        <p>Convert ETS2 sample to Tensors
Returns a dictionary with two elements, image and depth, both as Tensors
This class doesn't perform any transformation on the data, it just converts the data to Tensors</p>






              <details class="quote">
                <summary>Source code in <code>src/capo_tools/datasets/ETS2/dataset.py</code></summary>
                <pre class="codehilite"><code class="language-python">class ToTensor(object):
    """
    Convert ETS2 sample to Tensors
    Returns a dictionary with two elements, image and depth, both as Tensors
    This class doesn't perform any transformation on the data, it just converts the data to Tensors
    """
    def __call__(self, sample):
        image, depth = sample['image'], sample['depth']
        image = pil_to_tensor(image).float()
        depth = torch.from_numpy(depth).float().permute(2, 0, 1)

        metadata = sample['metadata']
        frame = sample['frame']

        return {'image': image, 'depth': depth, 'frame': frame, 'metadata': metadata}</code></pre>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="capo_tools.datasets.ETS2.ets2_tools.depth_file"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFile" class="doc doc-heading">
            <code>ETS2DepthFile</code>


<a href="#capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFile" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>src/capo_tools/datasets/ETS2/ets2_tools/depth_file.py</code></summary>
                <pre class="codehilite"><code class="language-python">class ETS2DepthFile:
    def __init__(self, file: str, far_value: float = 10000, eager_load: bool = True):
        """
        ETS2 dataset depth file reader
        Args:
            file ():
            far_value ():
            eager_load ():
        """
        # File must exist
        assert os.path.exists(file)
        self.base, _file_name = os.path.split(file)
        self.file_name, self.ext = os.path.splitext(_file_name)

        # File name assertions
        assert self.ext == ".raw"
        assert len(self.file_name.split('.')) &gt; 1
        assert self.file_name.split('.')[1] == 'depth'

        self.bit_depth = None
        self.data = None

        self.eager_load = eager_load
        self.far_value = far_value
        self._read_depth_file()

    def _read_depth_file(self):
        data = np.fromfile(os.path.join(self.base, f"{self.file_name}{self.ext}"), dtype='byte')
        self.header = ETS2DepthFileHeader(data)

        # TODO: review, find a better way to do this,
        #
        self.is_real_depth = (self.header.bit_depth == 16)

        if self.eager_load:
            self._read_data(data)
            del data

    def _read_depth_data(self, file_data):
        data_bytes = self.header.bit_depth // 8
        denorm = pow(2, 24) - 1
        # TODO: Review, this hardcoded 28 should be self.header.offset?
        format = '&lt;%sU' % int((self.header.size - 26) / data_bytes)
        self.data = np.array(rawutil.unpack(format, file_data[self.header.offset:]))
        # self.data = -np.frombuffer(file_data[self.header.offset:], dtype=np.float16).astype(np.float32)
        self.data = self.data / denorm
        # data = normalize(data)

    def _read_realdepth_data(self, file_data):
        data_bytes = self.header.bit_depth // 8

        # TODO: Review, make sure this is the same, as np.from_buffer is much much faster than rawutil.unpack
        # TODO: Review, this hardcoded 28 should be self.header.offset?
        # format = '&lt;%se' % int((self.header.size - 28) / data_bytes)
        # self.data = -np.array(rawutil.unpack(format, file_data[self.header.offset:]))
        self.data = -np.frombuffer(file_data[self.header.offset:], dtype=np.float16).astype(np.float32)

        # NaN handling
        data_nans = np.count_nonzero(np.isnan(self.data))
        if data_nans &gt; 0:
            warnings.warn(f"{os.path.join(self.base, f'{self.file_name}{self.ext}')}: There are {data_nans} NaN values in depth data, transforming them to zeros")
            self.data[np.isnan(self.data)] = 0

    def _read_data(self, data):
        if self.is_real_depth:
            self._read_realdepth_data(data)
        else:
            self._read_depth_data(data)

    def get_data(self):
        if self.data is None:
            data = np.fromfile(os.path.join(self.base, f"{self.file_name}{self.ext}"), dtype='byte')
            self._read_data(data)
            del data

        return self.data

    def size(self):
        return self.header.width, self.header.height</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFile.__init__" class="doc doc-heading">
            <code class=" language-python">__init__(file, far_value=10000, eager_load=True)</code>

<a href="#capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFile.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>ETS2 dataset depth file reader
Args:
    file ():
    far_value ():
    eager_load ():</p>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/ETS2/ets2_tools/depth_file.py</code></summary>
              <pre class="codehilite"><code class="language-python">def __init__(self, file: str, far_value: float = 10000, eager_load: bool = True):
    """
    ETS2 dataset depth file reader
    Args:
        file ():
        far_value ():
        eager_load ():
    """
    # File must exist
    assert os.path.exists(file)
    self.base, _file_name = os.path.split(file)
    self.file_name, self.ext = os.path.splitext(_file_name)

    # File name assertions
    assert self.ext == ".raw"
    assert len(self.file_name.split('.')) &gt; 1
    assert self.file_name.split('.')[1] == 'depth'

    self.bit_depth = None
    self.data = None

    self.eager_load = eager_load
    self.far_value = far_value
    self._read_depth_file()</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFileHeader" class="doc doc-heading">
            <code>ETS2DepthFileHeader</code>


<a href="#capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFileHeader" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>src/capo_tools/datasets/ETS2/ets2_tools/depth_file.py</code></summary>
                <pre class="codehilite"><code class="language-python">class ETS2DepthFileHeader:
    def __init__(self, data):
        """
        ETS2 Datset depth file header
        Args:
            data ():
        """
        self.magic: str = None
        self.size: int = None
        self.width: int = None
        self.height: int = None
        self.min_val: int = None
        self.max_val: int = None
        self.offset: int = None
        self.bit_depth: int = None
        self._read_header(data)

    def _read_header(self, data):
        if len(data) == 3525146:
            header = {
                "magic": bytes(struct.unpack('bb', data[0:2])).decode('utf-8'),
                "size": struct.unpack('&lt;l', data[2:6])[0],
                "width": struct.unpack('&lt;l', data[6:10])[0],
                "height": struct.unpack('&lt;l', data[10:14])[0],
                "min_val": struct.unpack('&lt;f', data[14:18])[0],
                "max_val": struct.unpack('&lt;f', data[18:22])[0],
                "offset": struct.unpack('&lt;l', data[22:26])[0],
                "bit_depth": 24
            }
        else:
            header = {
                "magic": bytes(struct.unpack('bb', data[0:2])).decode('utf-8'),
                "size": struct.unpack('&lt;l', data[2:6])[0],
                "width": struct.unpack('&lt;l', data[6:10])[0],
                "height": struct.unpack('&lt;l', data[10:14])[0],
                "min_val": struct.unpack('&lt;f', data[14:18])[0],
                "max_val": struct.unpack('&lt;f', data[18:22])[0],
                "bit_depth": struct.unpack('&lt;h', data[22:24])[0],
                "offset": struct.unpack('&lt;l', data[24:28])[0]
            }

        self.__dict__.update(header)
        del header

    def __str__(self):
        return (f"magic: {self.magic}, "
                f"size: {self.size}, "
                f"widht: {self.width}, "
                f"height: {self.height}, "
                f"minimum value: {self.min_val}, "
                f"maximum value: {self.max_val}, "
                f"bit depth: {self.bit_depth}, "
                f"offset: {self.offset}")</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFileHeader.__init__" class="doc doc-heading">
            <code class=" language-python">__init__(data)</code>

<a href="#capo_tools.datasets.ETS2.ets2_tools.depth_file.ETS2DepthFileHeader.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>ETS2 Datset depth file header
Args:
    data ():</p>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/datasets/ETS2/ets2_tools/depth_file.py</code></summary>
              <pre class="codehilite"><code class="language-python">def __init__(self, data):
    """
    ETS2 Datset depth file header
    Args:
        data ():
    """
    self.magic: str = None
    self.size: int = None
    self.width: int = None
    self.height: int = None
    self.min_val: int = None
    self.max_val: int = None
    self.offset: int = None
    self.bit_depth: int = None
    self._read_header(data)</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="capo_tools.display.tools.depth_tools"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="capo_tools.pt_functions.ffts"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="capo_tools.pt_functions.ffts.ffp3d" class="doc doc-heading">
            <code class=" language-python">ffp3d(tensor, kernel)</code>

<a href="#capo_tools.pt_functions.ffts.ffp3d" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Perform 3D Fast Fourier Transform and Convolution in the frequency domain.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tensor</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kernel</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convolution kernel.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.Tensor: Convolved tensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/pt_functions/ffts.py</code></summary>
              <pre class="codehilite"><code class="language-python">def ffp3d(tensor, kernel):
    """
    Perform 3D Fast Fourier Transform and Convolution in the frequency domain.

    Args:
        tensor (torch.Tensor): Input tensor.
        kernel (torch.Tensor): Convolution kernel.

    Returns:
        torch.Tensor: Convolved tensor.
    """
    c_org, h_org, w_org = tensor.size()
    kc, kh, kw = kernel.size()
    pad_c, pad_h, pad_w = kc // 2, kh // 2, kw // 2

    # Pad the input tensor
    tensor_pad = F.pad(tensor, (pad_w, pad_w, pad_h, pad_h, pad_c, pad_c))
    c, h, w = tensor_pad.size()

    # Compute FFT of kernel and input tensor
    kernel_fft = psf2otf3d(kernel, tensor_pad.size())
    tensor_fft = torch.fft.fftn(tensor_pad, s=(c, h, w))

    # Compute inverse FFT and extract the valid part
    k_conv_t = torch.fft.ifftn(kernel_fft * tensor_fft)[pad_c:pad_c + c_org, pad_h:pad_h + h_org, pad_w:pad_w + w_org]
    return k_conv_t</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="capo_tools.pt_functions.ffts.psf2otf3d" class="doc doc-heading">
            <code class=" language-python">psf2otf3d(kernel, input_shape, n=1)</code>

<a href="#capo_tools.pt_functions.ffts.psf2otf3d" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert PSF (Point Spread Function) to OTF (Optical Transfer Function) in the frequency domain.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kernel</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PSF kernel.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_shape</code>
            </td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shape of the input tensor (channels, height, width).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.Tensor: OTF of the kernel.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/capo_tools/pt_functions/ffts.py</code></summary>
              <pre class="codehilite"><code class="language-python">def psf2otf3d(kernel, input_shape, n=1):
    """
    Convert PSF (Point Spread Function) to OTF (Optical Transfer Function) in the frequency domain.

    Args:
        kernel (torch.Tensor): The PSF kernel.
        input_shape (tuple): Shape of the input tensor (channels, height, width).
        n (int): Number of samples. Defaults to 1.

    Returns:
        torch.Tensor: OTF of the kernel.
    """
    kc, kh, kw = kernel.size()
    c, h, w = input_shape
    pad_c, pad_h, pad_w = kc // 2, kh // 2, kw // 2

    # Pad the kernel and roll it
    kernel_pad = F.pad(kernel, (0, w - kw, 0, h - kh, 0, c - kc), "constant", 0)
    kernel_pad_roll = torch.roll(kernel_pad, shifts=(-pad_c, -pad_h, -pad_w), dims=(0, 1, 2))

    # Compute the OTF using FFT
    kernel_otf = torch.fft.fftn(kernel_pad_roll, s=(c, h, w))
    return kernel_otf</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
